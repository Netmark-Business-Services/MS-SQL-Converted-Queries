
SELECT 
	ashf.SUPPLIER_NAME AS ASHF_SUPPLIER_NAME,
	ashf.SUPPLIER_HCC_ID AS ASHF_SUPPLIER_HCC_ID,
	ashf.SUPPLIER_NPI  AS ASHF_SUPPLIER_NPI,
    CASE
        WHEN bnhf.BENEFIT_NETWORK_NAME IS NOT NULL THEN 'Par'
        ELSE 'Non-Par'
    END AS Network_Status,
    bnhf.BENEFIT_NETWORK_NAME,
    TE.TAX_ID AS  ASHF_TAX_ID,
    sl.SUPPLIER_LOCATION_NAME,
    sl.SUPPLIER_LOCATION_HCC_ID ,
    sl.SUPPLIER_LOCATION_NPI
FROM 
	payor_dw.supplier ashf 
LEFT JOIN
	payor_dw.POSTAL_ADDRESS pa ON ASHF.SUPPLIER_CORR_ADDRESS_KEY = pa.POSTAL_ADDRESS_KEY
LEFT JOIN 
	payor_dw.SUPPLIER_LOCATION sl ON ashf.SUPPLIER_KEY = sl.SUPPLIER_KEY 
LEFT JOIN 
	PAYOR_DW.TAX_ENTITY TE ON ashf.TAX_ENTITY_KEY = TE.TAX_ENTITY_KEY 
LEFT JOIN 
	PAYOR_DW.SUPPLIER_HIST_TO_BNFT_NETWORK shtbn ON ashf.SUPPLIER_HISTORY_FACT_KEY = shtbn.SUPPLIER_HISTORY_FACT_KEY 
LEFT JOIN 
	PAYOR_DW.BENEFIT_NETWORK_HISTORY_FACT bnhf ON shtbn.BENEFIT_NETWORK_KEY = bnhf.BENEFIT_NETWORK_KEY 
