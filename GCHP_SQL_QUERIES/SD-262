SELECT
    p.PRACTITIONER_HCC_ID,
    p.PRACTITIONER_FULL_NAME,
    p.PRACTITIONER_NPI,
    hfsc2.HISTORY_FACT_STATUS_DESC AS PRACTITIONER_STATUS,
    prhf.PRACTITIONER_ROLE_NAME,
    pt.PROVIDER_TAXONOMY_CODE,
    pt.SPECIALIZATION ,
    dd.DATE_VALUE  AS Active_DATE,
    dd2.DATE_VALUE  AS Termination_Date
FROM
	payor_dw.PRACTITIONER p
LEFT JOIN
	payor_dw.PRACTITIONER_ROLE_HISTORY_FACT prhf ON p.PRACTITIONER_KEY = prhf.PRACTITIONER_KEY
LEFT JOIN
	PAYOR_DW.PRACT_ROLE_HIST_TO_PROV_TXNMY prhtpt ON prhf.PRACTITIONER_ROLE_HIST_FCT_KEY = PRHTPT.PRACTITIONER_ROLE_HIST_FCT_KEY
LEFT JOIN
	PAYOR_DW.PROVIDER_TAXONOMY pt ON PRHTPT.PROVIDER_TAXONOMY_KEY = pt.PROVIDER_TAXONOMY_KEY
LEFT JOIN
    payor_dw.HISTORY_FACT_STATUS_CODE hfsc2 ON p.PRACTITIONER_STATUS = hfsc2.HISTORY_FACT_STATUS_CODE
LEFT JOIN
 	payor_dw.DATE_DIMENSION dd ON p.FIRST_EFFECTIVE_DATE_KEY = dd.DATE_KEY
LEFT JOIN
 	payor_dw.DATE_DIMENSION dd2 ON p.PRACT_TERMINATION_DATE_KEY = dd2.DATE_KEY 
