SELECT
    TE.TAX_ID AS Supplier_TAX_ID,
    ashf.SUPPLIER_HCC_ID AS SUPPLIER_ID,
    ashf.SUPPLIER_NPI  AS SUPPLIER_NPI,
    ashf.SUPPLIER_NAME AS SUPPLIER_NAME,
    ASHF.SUPPLIER_STATUS,
    dd.DATE_VALUE AS SUPPLIER_FIRST_EFFECTIVE_DATE,
    dd2.DATE_VALUE AS SUPPLIER_TERMINATION_DATE,
    PA.ADDRESS_LINE AS SUPPLIER_ADDRESS,
    PA.CITY_NAME AS SUPPLIER_CITY,
    PA.STATE_CODE AS SUPPLIER_STATE ,
    PA.ZIP_CODE AS SUPPLIER_ZIPCODE,
    pt.PROVIDER_TAXONOMY_NAME ,
    sl.SUPPLIER_LOCATION_HCC_ID ,
    sl.SUPPLIER_LOCATION_NAME ,
    sl.SUPPLIER_LOCATION_NPI,
    sl.SUPPLIER_LOCATION_STATUS,
    dd3.DATE_VALUE AS SUPPLIER_LOC_EFF_DATE,
    dd4.DATE_VALUE AS SUPPLIER_LOC_TERM_DATE
FROM
payor_dw.supplier ashf
LEFT JOIN
	payor_dw.POSTAL_ADDRESS pa ON ASHF.SUPPLIER_CORR_ADDRESS_KEY = pa.POSTAL_ADDRESS_KEY
LEFT JOIN
	payor_dw.SUPPLIER_LOCATION sl ON ashf.SUPPLIER_KEY = sl.SUPPLIER_KEY
LEFT JOIN
	payor_dw.TAX_ENTITY te ON ASHF.TAX_ENTITY_KEY = TE.TAX_ENTITY_KEY
LEFT JOIN
	payor_dw.PROVIDER_TAXONOMY pt ON ashf.PRIMARY_CLASSIFICATION_KEY = pt.PROVIDER_TAXONOMY_KEY
LEFT JOIN
	DATE_DIMENSION dd ON ASHF.FIRST_EFFECTIVE_DATE_KEY = dd.DATE_KEY
LEFT JOIN
	DATE_DIMENSION dd2 ON ASHF.SUPPLIER_TERMINATION_DATE_KEY = dd2.DATE_KEY
LEFT JOIN
	DATE_DIMENSION dd3 ON SL.SUPPLIER_LOC_EFF_DATE_KEY = dd3.DATE_KEY
LEFT JOIN
	DATE_DIMENSION dd4 ON SL.SUPPLIER_LOC_TERM_DATE_KEY = dd4.DATE_KEY
WHERE
	--sl.SUPPLIER_LOCATION_STATUS LIKE 't'
	--AND
	--ashf.SUPPLIER_HCC_ID ='1002046'
